<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Products | GrimmDraw</title>
  <style>
    /* Base styles... (same as your code above) */

    .highlight {
      animation: flash 1.5s ease-in-out;
      outline: 3px solid #f8c471;
      outline-offset: 3px;
      z-index: 1;
    }

    @keyframes flash {
      0%, 100% { box-shadow: 0 0 0px #f8c471; }
      50% { box-shadow: 0 0 25px #f8c471; }
    }
  </style>
</head>
<body>

  <footer>
    <p>&copy; 2025 GrimmDraw | All Rights Reserved</p>
  </footer>

  <script>
    const products = {
      tobacco: [
        { img: "seven stars cig.JPG", name: "SEVEN STARS CIGARETTES", price: 8.99 },
        { img: "red apple cig.JPG", name: "RED APPLE CIGARETTES", price: 7.50 },
        { img: "nike cig.jpeg", name: "CUSTOM NIKE CIGARETTES", price: 9.25 },
        { img: "lucky strike cig.JPG", name: "LUCKY STRIKE CIGARETTES", price: 7.99 },
        { img: "hupman.jpg", name: "HUPMAN CIGARETTES", price: 8.50 },
        { img: "waltz.jpeg", name: "WALTZ CIGARETTES", price: 6.75 },
        { img: "marlboro.JPG", name: "VINTAGE MARLBORO CIGARETTES", price: 9.99 },
        { img: "brown bear herbs.jpg", name: "BROWN BEAR CIGARETTES", price: 7.25 },
        { img: "newport mentol.jpeg", name: "NEWPORT CIGARETTES", price: 8.80 }
      ],
      nicotinePouches: [
        { img: "zyn chill.WEBP", name: "ZYN CHILLS", price: 5.99 },
        { img: "zyn citrus.WEBP", name: "ZYN CITRUS", price: 5.99 },
        { img: "zyn wintergreen.WEBP", name: "ZYN WINTERGREEN", price: 5.99 }
      ],
      lighters: [
        { img: "taylor swift lighter.JPG", name: "TAYLOR SWIFT CUSTOM LIGHTER", price: 12.00 },
        { img: "the shining lighter.JPG", name: "THE SHINING LIGHTER", price: 11.50 },
        { img: "rip bt lighter.JPG", name: "RIP BETTER DAYS LIGHTER", price: 10.75 },
        { img: "fuck it lighter.JPG", name: "F*CK IT LIGHTER", price: 9.99 },
        { img: "escape lighter.JPG", name: "ESCAPE LIGHTER", price: 10.50 },
        { img: "BAD lighter.JPG", name: "CUSTOM BAD LIGHTER", price: 13.20 },
        { img: "wavey lighter.JPG", name: "CUSTOM WAVEY LIGHTER", price: 13.00 },
        { img: "edward lighter.JPG", name: "EDWARD SCISSOR HANDS LIGHTER", price: 14.00 },
        { img: "80s lighter.JPG", name: "CUSTOM 80S LIGHTER", price: 12.75 }
      ],
      vapes: [
        { img: "vozol CB juice.JPG", name: "VOZOL CARIBBEAN JUICE 20K", price: 15.99 },
        { img: "vozol bluecherry.WEBP", name: "VOZOL BLUECHERRY 20K", price: 15.99 },
        { img: "vozol strawberry.WEBP", name: "VOZOL STRAWBERRY 20K", price: 15.99 },
        { img: "baang lichee.JPG", name: "BAANG LICHEE 2.4K", price: 14.50 },
        { img: "baang mixed fruit.JPG", name: "BAANG MIXED FRUIT 2.4K", price: 14.50 },
        { img: "baang peach ice.JPG", name: "BAANG PEACH ICE 2.4K", price: 14.50 },
        { img: "ivg 2400 maroon.webp", name: "IVG 2400 KIWI", price: 16.00 },
        { img: "ivg 2400 strawberry.JPG", name: "IVG 2400 STRAWBERRY", price: 16.00 },
        { img: "ivg 2400 tropical.JPG", name: "IVG 2400 TROPICAL", price: 16.00 }
      ],
      otherItems: [
        { img: "burn baby burn ash tray.JPG", name: "BBB ASH TRAY", price: 7.00 },
        { img: "marlboro ash tray.jpeg", name: "CUSTOM MARLBORO ASH TRAY", price: 8.00 },
        { img: "marlboro drawer.jpeg", name: "CUSTOM MARLBORO DRAWER", price: 9.50 },
        { img: "only for hot person ash tray.JPG", name: "OFHP ASH TRAY", price: 7.50 },
        { img: "puff puff pass ash tray.JPG", name: "PPP ASH TRAY", price: 7.25 }
      ]
    };

    const gridSections = {
      tobacco: document.getElementById("tobacco-grid"),
      nicotinePouches: document.getElementById("nicotine-pouches-grid"),
      lighters: document.getElementById("lighters-grid"),
      vapes: document.getElementById("vapes-grid"),
      otherItems: document.getElementById("other-items-grid")
    };

    for (const category in products) {
      products[category].forEach(product => {
        const card = document.createElement("div");
        card.classList.add("product");
        card.dataset.name = product.name.toLowerCase(); // for searching

        card.innerHTML = `
          <img src="${product.img}" alt="${product.name}" />
          <div class="product-info">
            <p>${product.name}</p>
            <p>Price: $${product.price.toFixed(2)}</p>
            <button class="add-to-cart">Add to Cart</button>
          </div>
        `;

        gridSections[category].appendChild(card);
      });
    }

    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const totalCount = cart.reduce((sum, item) => sum + item.quantity, 0);
      document.getElementById("cart-count").innerText = totalCount;
    }

    updateCartCount();

    document.addEventListener("click", function (e) {
      if (e.target.classList.contains("add-to-cart")) {
        const productCard = e.target.closest(".product");
        const name = productCard.querySelector("p").innerText;

        let foundProduct = null;
        for (const category in products) {
          foundProduct = products[category].find(p => p.name === name);
          if (foundProduct) break;
        }

        if (!foundProduct) return;

        const cartItem = {
          img: foundProduct.img,
          name: foundProduct.name,
          price: foundProduct.price,
          quantity: 1
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existingItem = cart.find(item => item.name === name);
        if (existingItem) {
          existingItem.quantity++;
        } else {
          cart.push(cartItem);
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartCount();
      }
    });

    // âœ… Scroll and highlight products based on search param
    function handleSearchParam() {
      const urlParams = new URLSearchParams(window.location.search);
      const query = urlParams.get("search");
      if (!query) return;

      const lowerQuery = query.toLowerCase();
      const matchedProducts = Array.from(document.querySelectorAll(".product"))
        .filter(p => p.dataset.name.includes(lowerQuery));

      if (matchedProducts.length > 0) {
        const firstMatch = matchedProducts[0];
        firstMatch.scrollIntoView({ behavior: "smooth", block: "center" });
        matchedProducts.forEach(el => el.classList.add("highlight"));
        setTimeout(() => {
          matchedProducts.forEach(el => el.classList.remove("highlight"));
        }, 3000);
      }
    }

    window.addEventListener("load", handleSearchParam);
  </script>
</body>
</html>
